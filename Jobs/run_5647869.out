Numpy Train Statistics:
torch.Size([2570, 19])
torch.Size([2570, 1])
############### Propensity Score SAE net Training ###############
.. Training started ..
##### train e2e #########
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.028483186434540484
Epoch: 200, loss: 0.021447565556032423
Epoch: 300, loss: 0.019909118279170843
Epoch: 400, loss: 0.019017582333842178
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 15.102534759789705, correct: 2343/2570, accuracy: 0.9116731517509727
Epoch: 50, loss: 14.467214472591877, correct: 2343/2570, accuracy: 0.9116731517509727
########## train layer wise all layer active ############
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.08256773498875124
Epoch: 200, loss: 0.08211241722290899
Epoch: 300, loss: 0.07814264922966192
Epoch: 400, loss: 0.07934597272563863
----- Training SAE -----
Epoch: 100, loss: 0.08954609525792392
Epoch: 200, loss: 0.08904077664569572
Epoch: 300, loss: 0.08463657711759026
Epoch: 400, loss: 0.0869792213226542
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 15.991876281797886, correct: 2328/2570, accuracy: 0.9058365758754864
Epoch: 50, loss: 14.98873683437705, correct: 2336/2570, accuracy: 0.9089494163424124
########## train layer wise only newly stacked layer active ############
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.08614381485515171
Epoch: 200, loss: 0.08389529962966472
Epoch: 300, loss: 0.08048426893390255
Epoch: 400, loss: 0.08208521276160523
----- Training SAE -----
Epoch: 100, loss: 0.09012510903455594
Epoch: 200, loss: 0.0893802637303317
Epoch: 300, loss: 0.09026044975092382
Epoch: 400, loss: 0.08993189791102468
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 15.478419668972492, correct: 2332/2570, accuracy: 0.9073929961089494
Epoch: 50, loss: 14.994690150022507, correct: 2337/2570, accuracy: 0.9093385214007782
Training completed..
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
treated: 237
control: 2333
total: 2570
[0.041886840015649796, 0.060489166527986526, 0.007384686730802059, 0.21178579330444336, 0.3395380675792694, 0.08467795699834824, 0.04586193338036537, 0.049458179622888565, 0.189723402261734, 0.07649936527013779, 0.9428890943527222, 0.9886136054992676, 0.26155737042427063, 0.0356178805232048, 0.20750980079174042, 0.18904541432857513, 0.3415507972240448, 0.34562283754348755, 0.9294975996017456, 0.3414861857891083, 0.4325544834136963, 0.3387843668460846, 0.2386312186717987, 0.315341591835022, 0.3295174837112427, 0.096328005194664, 0.9809603691101074, 0.29305142164230347, 0.3412606120109558, 0.03648432344198227, 0.3357055187225342, 0.33771535754203796, 0.32463338971138, 0.3427391052246094, 0.34006786346435547, 0.42560482025146484, 0.33513399958610535, 0.34507906436920166, 0.2643487751483917, 0.1869329959154129, 0.2839887738227844, 0.9960711002349854, 0.35524317622184753, 0.34396490454673767, 0.22516652941703796, 0.3565511703491211, 0.33324307203292847, 0.31243160367012024, 0.49929535388946533, 0.3009189963340759, 0.3069301247596741, 0.9709916710853577, 0.03895715996623039, 0.9663177132606506, 0.32607725262641907, 0.055777981877326965, 0.3949393928050995, 0.3365059494972229, 0.30178001523017883, 0.33194583654403687, 0.3634068965911865, 0.34261325001716614, 0.32079023122787476, 0.34094303846359253, 0.34258759021759033, 0.31141820549964905, 0.33179423213005066, 0.3428501486778259, 0.34122389554977417, 0.34254419803619385, 0.33924317359924316, 0.34289658069610596, 0.30151376128196716, 0.3395867347717285, 0.3502972424030304, 0.3427053391933441, 0.3328661024570465, 0.34296780824661255, 0.3426780104637146, 0.33989471197128296, 0.342733770608902, 0.3429243564605713, 0.3429076373577118, 0.34256842732429504, 0.3427749574184418, 0.339480459690094, 0.34024715423583984, 0.34024715423583984, 0.303824782371521, 0.3427481949329376, 0.3428904712200165, 0.3427676558494568, 0.3172134757041931, 0.3299206793308258, 0.32409557700157166, 0.301763117313385, 0.343513160943985, 0.356574684381485, 0.3404824137687683, 0.3567357361316681, 0.31577861309051514, 0.3417781889438629, 0.337516188621521, 0.3220273554325104, 0.31602513790130615, 0.3175005614757538, 0.354811429977417, 0.30101484060287476, 0.3391767740249634, 0.3498508036136627, 0.2268713265657425, 0.3256070017814636, 0.31141820549964905, 0.33790406584739685, 0.7987287044525146, 0.292387992143631, 0.343894898891449, 0.24788159132003784, 0.23167438805103302, 0.3534018397331238, 0.3451153039932251, 0.8140499591827393, 0.3482237756252289, 0.356574684381485, 0.356574684381485, 0.33371707797050476, 0.36386871337890625, 0.23679569363594055, 0.3532206118106842, 0.2974998354911804, 0.3602750301361084, 0.3602750301361084, 0.3438996970653534, 0.3643862009048462, 0.3619426488876343, 0.34712982177734375, 0.36329108476638794, 0.36329108476638794, 0.35063591599464417, 0.3655310273170471, 0.24385401606559753, 0.34986352920532227, 0.16803456842899323, 0.5799118280410767, 0.34097418189048767, 0.34287557005882263, 0.3425278663635254, 0.3428439497947693, 0.2488263100385666, 0.3426426649093628, 0.33167025446891785, 0.34254276752471924, 0.34281739592552185, 0.14130567014217377, 0.34254154562950134, 0.3266018331050873, 0.7606775760650635, 0.34289658069610596, 0.3426981270313263, 0.3429671823978424, 0.34295815229415894, 0.3429184556007385, 0.3429834246635437, 0.3422105014324188, 0.34263065457344055, 0.34289658069610596, 0.3427201509475708, 0.3424731492996216, 0.34287557005882263, 0.34287557005882263, 0.3428693115711212, 0.3403298258781433, 0.3426997661590576, 0.3428858518600464, 0.3221231698989868, 0.3424969017505646, 0.34288379549980164, 0.34289461374282837, 0.3296798765659332, 0.3427838087081909, 0.3429079055786133, 0.3429079055786133, 0.33970656991004944, 0.3429199457168579, 0.3426525890827179, 0.34291088581085205, 0.342763751745224, 0.34278690814971924, 0.34296780824661255, 0.3426981270313263, 0.3426981270313263, 0.3428337574005127, 0.34283706545829773, 0.3429327607154846, 0.3427119255065918, 0.34276658296585083, 0.3427779972553253, 0.342292845249176, 0.34267687797546387, 0.3423999845981598, 0.34224697947502136, 0.34273427724838257, 0.34285321831703186, 0.34282851219177246, 0.34281614422798157, 0.3428959548473358, 0.3429022431373596, 0.341714084148407, 0.3427860140800476, 0.34279751777648926, 0.34280791878700256, 0.3429787755012512, 0.3428920805454254, 0.34273624420166016, 0.34275704622268677, 0.34280073642730713, 0.3428913652896881, 0.34289565682411194, 0.34024715423583984, 0.34297680854797363, 0.3424427807331085, 0.34287527203559875, 0.3426538407802582, 0.3428778350353241, 0.34298640489578247, 0.34134793281555176, 0.34294259548187256, 0.33629539608955383, 0.33629539608955383, 0.31381943821907043, 0.34128132462501526, 0.34258460998535156, 0.3447001576423645, 0.34391242265701294, 0.2616196572780609, 0.3408416509628296, 0.3362210690975189]
Using original data
cuda:0
{'epochs': 400, 'lr': 0.001, 'batch_size': 32, 'shuffle': True, 'sparsity_probability': 0.8, 'weight_decay': 0.0003, 'BETA': 0.1}
########### 400 epochs ###########
----------------------------------------
iter_id: 0
----------------------------------------
Numpy Train Statistics:
torch.Size([2570, 19])
torch.Size([2570, 1])
Numpy Test Statistics:
torch.Size([642, 19])
torch.Size([642, 1])
----------- Training and evaluation phase ------------
############### Propensity Score neural net Training ###############
.. Training started ..
Saved model path: ./Propensity_Model/NN_PS_model_iter_id_0_epoch_50_lr_0.001.pth
Epoch: 25, loss: 15.015162283554673, correct: 2336/2570, accuracy: 0.9089494163424124
Epoch: 50, loss: 14.595773857086897, correct: 2346/2570, accuracy: 0.91284046692607
Saved model..
.. Propensity score evaluation started using NN..
.. Propensity score evaluation completed using NN..
############### DCN Training using NN ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/NN_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 849.4610292583287
epoch: 19, Treated + Control loss: 826.4970160494748
epoch: 29, Treated + Control loss: 811.6367979920892
epoch: 39, Treated + Control loss: 765.7443805366256
epoch: 49, Treated + Control loss: 801.0672748911345
epoch: 59, Treated + Control loss: 773.0765861899812
epoch: 69, Treated + Control loss: 743.7160564003036
epoch: 79, Treated + Control loss: 767.5938722963317
epoch: 89, Treated + Control loss: 759.3268729915583
epoch: 99, Treated + Control loss: 750.5998875100654
Neural Net start time: = 2025-01-02 13:39:57.334200
Neural Net end time: = 2025-01-02 13:44:49.093288
{'epochs': 400, 'lr': 0.001, 'batch_size': 32, 'shuffle': True, 'train_set': <torch.utils.data.dataset.TensorDataset object at 0x1485d2676bc0>, 'sparsity_probability': 0.8, 'weight_decay': 0.0003, 'BETA': 0.1, 'input_nodes': 17}
############### Propensity Score SAE net Training ###############
.. Training started ..
##### train e2e #########
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.03993901235545859
Epoch: 200, loss: 0.022668908522636803
Epoch: 300, loss: 0.02026999733744212
Epoch: 400, loss: 0.017536617125625962
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 15.198111273348331, correct: 2341/2570, accuracy: 0.9108949416342412
Epoch: 50, loss: 14.108074597083032, correct: 2349/2570, accuracy: 0.9140077821011673
########## train layer wise all layer active ############
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.08722171665709695
Epoch: 200, loss: 0.0822363811786528
Epoch: 300, loss: 0.08683622053559915
Epoch: 400, loss: 0.07917241715354684
----- Training SAE -----
Epoch: 100, loss: 0.09442686142376912
Epoch: 200, loss: 0.08877230458605437
Epoch: 300, loss: 0.0883043764366044
Epoch: 400, loss: 0.08948137404190169
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 15.691777050495148, correct: 2341/2570, accuracy: 0.9108949416342412
Epoch: 50, loss: 14.874785386025906, correct: 2342/2570, accuracy: 0.911284046692607
########## train layer wise only newly stacked layer active ############
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.08427128931622446
Epoch: 200, loss: 0.08370527786053257
Epoch: 300, loss: 0.0812014698246379
Epoch: 400, loss: 0.0814979150891304
----- Training SAE -----
Epoch: 100, loss: 0.08685435446692102
Epoch: 200, loss: 0.09492118527859818
Epoch: 300, loss: 0.08880273740232726
Epoch: 400, loss: 0.09207089962782683
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 15.98205292224884, correct: 2333/2570, accuracy: 0.9077821011673152
Epoch: 50, loss: 14.932078961282969, correct: 2332/2570, accuracy: 0.9073929961089494
Training completed..
---------------------------------------------------------------------------
End to End SAE training
---------------------------------------------------------------------------
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
############### DCN Training using SAE ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/SAE_E2E_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 858.6588936562525
epoch: 19, Treated + Control loss: 825.8916168205843
epoch: 29, Treated + Control loss: 789.7704397196744
epoch: 39, Treated + Control loss: 791.3957756622283
epoch: 49, Treated + Control loss: 780.2155249415409
epoch: 59, Treated + Control loss: 768.5652108289365
epoch: 69, Treated + Control loss: 761.3764088188955
epoch: 79, Treated + Control loss: 751.6702494522835
epoch: 89, Treated + Control loss: 746.3159946920026
epoch: 99, Treated + Control loss: 744.5553790755996
SAE E2E start time: = 2025-01-02 13:49:59.318051
SAE E2E end time: = 2025-01-02 13:54:45.279456
---------------------------------------------------------------------------
----------Layer wise greedy stacked SAE training - All layers----------
---------------------------------------------------------------------------
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
############### DCN Training using SAE ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/SAE_stacked_all_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 849.7456008016443
epoch: 19, Treated + Control loss: 830.5152200815417
epoch: 29, Treated + Control loss: 776.8599371060216
epoch: 39, Treated + Control loss: 788.6137190456657
epoch: 49, Treated + Control loss: 770.6211986779483
epoch: 59, Treated + Control loss: 758.0195158116761
epoch: 69, Treated + Control loss: 756.1879471687062
epoch: 79, Treated + Control loss: 761.8748378434119
epoch: 89, Treated + Control loss: 745.9495670534232
epoch: 99, Treated + Control loss: 733.0340156134826
SAE all layer active start time: = 2025-01-02 13:54:45.279479
SAE all layer active end time: = 2025-01-02 13:59:30.176992
---------------------------------------------------------------------------
Layer wise greedy stacked SAE training - Current layers
---------------------------------------------------------------------------
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
############### DCN Training using SAE ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/SAE_stacked_cur_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 873.9775787557194
epoch: 19, Treated + Control loss: 817.56358888808
epoch: 29, Treated + Control loss: 806.3377404477724
epoch: 39, Treated + Control loss: 788.0435356043135
epoch: 49, Treated + Control loss: 780.7320568618886
epoch: 59, Treated + Control loss: 782.748057941631
epoch: 69, Treated + Control loss: 764.0970426857093
epoch: 79, Treated + Control loss: 762.8735285256195
epoch: 89, Treated + Control loss: 754.1882330853399
epoch: 99, Treated + Control loss: 764.8660924330995
SAE cur layer active start time: = 2025-01-02 13:59:30.177014
SAE all layer active end time: = 2025-01-02 14:04:15.230770
############### DCN Training using Logistic Regression ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/LR_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 866.5629051340696
epoch: 19, Treated + Control loss: 813.2247092504629
epoch: 29, Treated + Control loss: 803.6655315714788
epoch: 39, Treated + Control loss: 778.9207974488054
epoch: 49, Treated + Control loss: 780.8928733619259
epoch: 59, Treated + Control loss: 778.7658754694222
epoch: 69, Treated + Control loss: 775.212117990503
epoch: 79, Treated + Control loss: 763.857231747083
epoch: 89, Treated + Control loss: 767.3505232759035
epoch: 99, Treated + Control loss: 735.9066550856037
Logistic Regression start time: = 2025-01-02 14:04:15.230804
Logistic Regression end time: = 2025-01-02 14:08:59.330629
############### DCN Training using Logistic Regression Lasso ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/LR_Lasso_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 872.4804001533244
epoch: 19, Treated + Control loss: 824.8196128825227
epoch: 29, Treated + Control loss: 817.7322628481315
epoch: 39, Treated + Control loss: 782.1240117429068
epoch: 49, Treated + Control loss: 766.6704780967871
epoch: 59, Treated + Control loss: 764.3755235402064
epoch: 69, Treated + Control loss: 756.4476417843191
epoch: 79, Treated + Control loss: 804.148964706732
epoch: 89, Treated + Control loss: 749.9805308286839
epoch: 99, Treated + Control loss: 735.5179281534495
Logistic Regression Lasso start time: = 2025-01-02 14:08:59.330679
Logistic Regression Lasso end time: = 2025-01-02 14:13:43.663319
----------- Testing phase ------------
############### DCN Testing using NN ###############
.. Propensity score evaluation started using NN..
.. Propensity score evaluation completed using NN..
Treated Statistics ==>
torch.Size([60, 17])
Control Statistics ==>
torch.Size([582, 17])
.. Evaluation started ..
bias_att: 0.19285714285714287
policy_value: 0.7366898148148149
Risk: 0.2633101851851851
atc_pred: 0.13095238095238096
att_pred: -0.1
err_fact: 0.17445482866043613
############### DCN Testing using SAE E2E ###############
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
Treated Statistics ==>
torch.Size([60, 17])
Control Statistics ==>
torch.Size([582, 17])
.. Evaluation started ..
bias_att: 0.19285714285714287
policy_value: 0.6882716049382717
Risk: 0.31172839506172834
atc_pred: 0.011904761904761904
att_pred: -0.1
err_fact: 0.1853582554517134
############### DCN Testing using SAE Stacked all layer active ###############
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
Treated Statistics ==>
torch.Size([60, 17])
Control Statistics ==>
torch.Size([582, 17])
.. Evaluation started ..
bias_att: 0.1595238095238095
policy_value: 0.6834656084656084
Risk: 0.31653439153439156
atc_pred: 0.10714285714285714
att_pred: -0.06666666666666667
err_fact: 0.1806853582554517
############### DCN Testing using SAE cur layer active ###############
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
Treated Statistics ==>
torch.Size([60, 17])
Control Statistics ==>
torch.Size([582, 17])
.. Evaluation started ..
bias_att: 0.17619047619047618
policy_value: 0.7172484984984985
Risk: 0.2827515015015015
atc_pred: 0.03571428571428571
att_pred: -0.08333333333333333
err_fact: 0.17757009345794392
Treated Statistics ==>
torch.Size([60, 17])
Control Statistics ==>
torch.Size([582, 17])
############### DCN Testing using LR ###############
.. Evaluation started ..
bias_att: 0.20952380952380953
policy_value: 0.716282894736842
Risk: 0.28371710526315796
atc_pred: 0.011904761904761904
att_pred: -0.11666666666666667
err_fact: 0.1822429906542056
Treated Statistics ==>
torch.Size([60, 17])
Control Statistics ==>
torch.Size([582, 17])
############### DCN Testing using LR Lasso ###############
.. Evaluation started ..
bias_att: 0.17619047619047618
policy_value: 0.7245696400625978
Risk: 0.27543035993740217
atc_pred: 0.10714285714285714
att_pred: -0.08333333333333333
err_fact: 0.18847352024922118

-------------------------------------------------

Using NN, bias_att: 0.19285714285714287, SD: 0.0
Using NN, policy_risk: 0.2633101851851851, SD: 0.0

-------------------------------------------------

Using SAE E2E, bias_att: 0.19285714285714287, SD: 0.0
Using SAE E2E, policy_risk: 0.31172839506172834, SD: 0.0

-------------------------------------------------

Using SAE stacked all layer active, bias_att: 0.1595238095238095, SD: 0.0
Using SAE stacked all layer active, policy_risk: 0.31653439153439156, SD: 0.0

-------------------------------------------------

Using SAE stacked cur layer active, bias_att: 0.17619047619047618, SD: 0.0
Using SAE stacked cur layer active, policy_risk: 0.2827515015015015, SD: 0.0

-------------------------------------------------

Using Logistic Regression, bias_att: 0.20952380952380953, SD: 0.0
Using Logistic Regression, policy_risk: 0.28371710526315796, SD: 0.0

-------------------------------------------------

Using Lasso Logistic Regression, bias_att: 0.17619047619047618, SD: 0.0
Using Lasso Logistic Regression, policy_risk: 0.27543035993740217, SD: 0.0
----------------------------------------
