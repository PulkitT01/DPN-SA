Numpy Train Statistics:
torch.Size([2570, 19])
torch.Size([2570, 1])
############### Propensity Score SAE net Training ###############
.. Training started ..
##### train e2e #########
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.028381885466292316
Epoch: 200, loss: 0.021265687691162764
Epoch: 300, loss: 0.018232660965971006
Epoch: 400, loss: 0.01718799651450949
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 14.899350054562092, correct: 2340/2570, accuracy: 0.9105058365758755
Epoch: 50, loss: 14.32929867785424, correct: 2347/2570, accuracy: 0.9132295719844358
########## train layer wise all layer active ############
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.0912767984892851
Epoch: 200, loss: 0.08017459359985811
Epoch: 300, loss: 0.07965668957726454
Epoch: 400, loss: 0.08292148000112286
----- Training SAE -----
Epoch: 100, loss: 0.08879492753817711
Epoch: 200, loss: 0.08754323229745582
Epoch: 300, loss: 0.0881569680792314
Epoch: 400, loss: 0.08431295443464208
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 15.871741443872452, correct: 2338/2570, accuracy: 0.909727626459144
Epoch: 50, loss: 15.069765523076057, correct: 2340/2570, accuracy: 0.9105058365758755
########## train layer wise only newly stacked layer active ############
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.08621426359002973
Epoch: 200, loss: 0.07932049279779564
Epoch: 300, loss: 0.08559773425445144
Epoch: 400, loss: 0.08351457979024192
----- Training SAE -----
Epoch: 100, loss: 0.08952391423560956
Epoch: 200, loss: 0.09402633844702332
Epoch: 300, loss: 0.08769059424966942
Epoch: 400, loss: 0.08592900459045245
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 16.005479648709297, correct: 2334/2570, accuracy: 0.9081712062256809
Epoch: 50, loss: 15.675295881927013, correct: 2332/2570, accuracy: 0.9073929961089494
Training completed..
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
treated: 237
control: 2333
total: 2570
[0.06730245053768158, 0.09401746839284897, 0.001085703494027257, 0.0689726173877716, 0.6224315166473389, 0.10714560747146606, 0.1288203001022339, 0.09787678718566895, 0.35960841178894043, 0.07958362996578217, 0.8239089846611023, 0.9746835231781006, 0.10040980577468872, 0.0646761879324913, 0.07156870514154434, 0.7731924653053284, 0.42934131622314453, 0.833755612373352, 0.9509136080741882, 0.4291551411151886, 0.7919571399688721, 0.3441741168498993, 0.4974888563156128, 0.12253881990909576, 0.5235822796821594, 0.14901648461818695, 0.9883054494857788, 0.41243189573287964, 0.428850382566452, 0.10473926365375519, 0.3901456594467163, 0.5395876169204712, 0.4029054641723633, 0.4315761923789978, 0.5073344707489014, 0.14621175825595856, 0.3774001896381378, 0.5696427226066589, 0.5142096877098083, 0.10089084506034851, 0.4666312634944916, 0.9896824955940247, 0.5788628458976746, 0.5746179223060608, 0.3856477737426758, 0.8595004081726074, 0.40820932388305664, 0.516654372215271, 0.8053094148635864, 0.3098453879356384, 0.41222816705703735, 0.987441897392273, 0.12171712517738342, 0.9858572483062744, 0.38104212284088135, 0.07033280283212662, 0.8986222147941589, 0.42886611819267273, 0.3138298988342285, 0.411880224943161, 0.7332144975662231, 0.42904961109161377, 0.2762077748775482, 0.4279451370239258, 0.43683183193206787, 0.41960087418556213, 0.7254529595375061, 0.43175017833709717, 0.4118817150592804, 0.43094727396965027, 0.43112096190452576, 0.43004173040390015, 0.5019114017486572, 0.368409663438797, 0.5759977102279663, 0.43575870990753174, 0.4033389091491699, 0.4311566948890686, 0.4359869658946991, 0.3905308246612549, 0.4361949861049652, 0.44064509868621826, 0.44042330980300903, 0.43411242961883545, 0.5715968608856201, 0.36192676424980164, 0.4374517798423767, 0.4374517798423767, 0.19652646780014038, 0.436891108751297, 0.439326673746109, 0.43811294436454773, 0.17617087066173553, 0.18946610391139984, 0.40845876932144165, 0.31555142998695374, 0.5679057836532593, 0.5841038227081299, 0.4323597848415375, 0.6339774131774902, 0.31726256012916565, 0.4320034980773926, 0.6869112849235535, 0.4187961220741272, 0.3269815444946289, 0.39586853981018066, 0.5841227769851685, 0.4091496467590332, 0.42962366342544556, 0.5803818106651306, 0.6985054612159729, 0.424844890832901, 0.41960087418556213, 0.5529722571372986, 0.8975297808647156, 0.42556101083755493, 0.5760672092437744, 0.4272308647632599, 0.38365134596824646, 0.5721352696418762, 0.5743761658668518, 0.9023128151893616, 0.5861524343490601, 0.5841038227081299, 0.5841038227081299, 0.5529834628105164, 0.3321303129196167, 0.7432472705841064, 0.5808987021446228, 0.459993451833725, 0.5836902856826782, 0.5836902856826782, 0.5752506256103516, 0.582124650478363, 0.583403468132019, 0.5732076168060303, 0.5830968618392944, 0.5830968618392944, 0.576848566532135, 0.5827785730361938, 0.2672652304172516, 0.44098684191703796, 0.37120646238327026, 0.8265100717544556, 0.42792996764183044, 0.4295971095561981, 0.4266422390937805, 0.4290836453437805, 0.7709246277809143, 0.38747474551200867, 0.41410037875175476, 0.43144428730010986, 0.4289517402648926, 0.1423800140619278, 0.43257734179496765, 0.3998405933380127, 0.8111594319343567, 0.43004173040390015, 0.43551719188690186, 0.4310768246650696, 0.43096643686294556, 0.43348798155784607, 0.4359840154647827, 0.42647263407707214, 0.43366286158561707, 0.43004173040390015, 0.43244534730911255, 0.43207624554634094, 0.4295971095561981, 0.4295971095561981, 0.4316486716270447, 0.43449658155441284, 0.4322090744972229, 0.4298168420791626, 0.4243372976779938, 0.43333616852760315, 0.4323344826698303, 0.4319567084312439, 0.3593809902667999, 0.4329264163970947, 0.4302622377872467, 0.4302622377872467, 0.36343464255332947, 0.43047046661376953, 0.43512558937072754, 0.4330110251903534, 0.43649834394454956, 0.43650946021080017, 0.4311566948890686, 0.43551719188690186, 0.43551719188690186, 0.4393893778324127, 0.43939873576164246, 0.43066027760505676, 0.4362088143825531, 0.43629229068756104, 0.4362213909626007, 0.4278782904148102, 0.4356403946876526, 0.429554283618927, 0.4263778328895569, 0.43712112307548523, 0.43421104550361633, 0.43527865409851074, 0.43920326232910156, 0.44026708602905273, 0.44039222598075867, 0.4161246418952942, 0.43838295340538025, 0.438514769077301, 0.4390455186367035, 0.43564891815185547, 0.4350014925003052, 0.43772584199905396, 0.43767496943473816, 0.43824976682662964, 0.4402555525302887, 0.4402933716773987, 0.4374517798423767, 0.43694397807121277, 0.43667468428611755, 0.4356119930744171, 0.43054938316345215, 0.4400484263896942, 0.44061756134033203, 0.4371856451034546, 0.43769076466560364, 0.43465638160705566, 0.43465638160705566, 0.4268057346343994, 0.42940258979797363, 0.43295636773109436, 0.43407824635505676, 0.4341798424720764, 0.42732805013656616, 0.4384641647338867, 0.43533194065093994]
Using original data
cuda:0
{'epochs': 400, 'lr': 0.001, 'batch_size': 32, 'shuffle': True, 'sparsity_probability': 0.8, 'weight_decay': 0.0003, 'BETA': 0.1}
########### 400 epochs ###########
----------------------------------------
iter_id: 0
----------------------------------------
Numpy Train Statistics:
torch.Size([2570, 19])
torch.Size([2570, 1])
Numpy Test Statistics:
torch.Size([642, 19])
torch.Size([642, 1])
----------- Training and evaluation phase ------------
############### Propensity Score neural net Training ###############
.. Training started ..
Saved model path: ./Propensity_Model/NN_PS_model_iter_id_0_epoch_50_lr_0.001.pth
Epoch: 25, loss: 15.338571287691593, correct: 2337/2570, accuracy: 0.9093385214007782
Epoch: 50, loss: 14.277409568428993, correct: 2342/2570, accuracy: 0.911284046692607
Saved model..
.. Propensity score evaluation started using NN..
.. Propensity score evaluation completed using NN..
############### DCN Training using NN ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/NN_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 835.1838359224544
epoch: 19, Treated + Control loss: 809.1973163777648
epoch: 29, Treated + Control loss: 803.5386470937015
epoch: 39, Treated + Control loss: 783.0698696372036
epoch: 49, Treated + Control loss: 763.4709133519651
epoch: 59, Treated + Control loss: 774.0572072813588
epoch: 69, Treated + Control loss: 763.2375809080311
epoch: 79, Treated + Control loss: 756.064395384911
epoch: 89, Treated + Control loss: 766.0895034319489
epoch: 99, Treated + Control loss: 752.175068620045
Neural Net start time: = 2024-12-23 13:35:41.270833
Neural Net end time: = 2024-12-23 13:40:36.561691
{'epochs': 400, 'lr': 0.001, 'batch_size': 32, 'shuffle': True, 'train_set': <torch.utils.data.dataset.TensorDataset object at 0x14e0dcb7eb90>, 'sparsity_probability': 0.8, 'weight_decay': 0.0003, 'BETA': 0.1, 'input_nodes': 17}
############### Propensity Score SAE net Training ###############
.. Training started ..
##### train e2e #########
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.03338188179021264
Epoch: 200, loss: 0.024144754779559595
Epoch: 300, loss: 0.022387366776389105
Epoch: 400, loss: 0.020298171891934343
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 15.354378402233124, correct: 2333/2570, accuracy: 0.9077821011673152
Epoch: 50, loss: 14.207549814134836, correct: 2346/2570, accuracy: 0.91284046692607
########## train layer wise all layer active ############
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.0828303495582975
Epoch: 200, loss: 0.08606461959856528
Epoch: 300, loss: 0.08364653040045573
Epoch: 400, loss: 0.08453940328808478
----- Training SAE -----
Epoch: 100, loss: 0.09036532347952878
Epoch: 200, loss: 0.08919576297939559
Epoch: 300, loss: 0.08747846421636181
Epoch: 400, loss: 0.08444474904257575
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 16.049378871917725, correct: 2333/2570, accuracy: 0.9077821011673152
Epoch: 50, loss: 15.200897619128227, correct: 2336/2570, accuracy: 0.9089494163424124
########## train layer wise only newly stacked layer active ############
Training mode: train
----- Training SAE -----
Epoch: 100, loss: 0.08472301622415766
Epoch: 200, loss: 0.08138253052293519
Epoch: 300, loss: 0.08426224877252991
Epoch: 400, loss: 0.0812328700206162
----- Training SAE -----
Epoch: 100, loss: 0.09174317958546274
Epoch: 200, loss: 0.09152395094250455
Epoch: 300, loss: 0.08776184226627703
Epoch: 400, loss: 0.0862301342005347
.. Propensity score evaluation started using Sparse AE..
Epoch: 25, loss: 16.1206542737782, correct: 2321/2570, accuracy: 0.9031128404669261
Epoch: 50, loss: 15.509161412715912, correct: 2333/2570, accuracy: 0.9077821011673152
Training completed..
---------------------------------------------------------------------------
End to End SAE training
---------------------------------------------------------------------------
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
############### DCN Training using SAE ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/SAE_E2E_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 877.798659702849
epoch: 19, Treated + Control loss: 804.9408967011616
epoch: 29, Treated + Control loss: 798.8506651565817
epoch: 39, Treated + Control loss: 782.5350677194378
epoch: 49, Treated + Control loss: 776.1976701644344
epoch: 59, Treated + Control loss: 765.4066335744336
epoch: 69, Treated + Control loss: 770.090596745732
epoch: 79, Treated + Control loss: 752.9373845084872
epoch: 89, Treated + Control loss: 747.7594610501119
epoch: 99, Treated + Control loss: 741.262511431764
SAE E2E start time: = 2024-12-23 13:45:57.396381
SAE E2E end time: = 2024-12-23 13:50:46.989859
---------------------------------------------------------------------------
----------Layer wise greedy stacked SAE training - All layers----------
---------------------------------------------------------------------------
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
############### DCN Training using SAE ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/SAE_stacked_all_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 841.2192428641931
epoch: 19, Treated + Control loss: 804.385924912661
epoch: 29, Treated + Control loss: 794.4097617191369
epoch: 39, Treated + Control loss: 801.8502753223102
epoch: 49, Treated + Control loss: 765.0769379017776
epoch: 59, Treated + Control loss: 767.6775983118871
epoch: 69, Treated + Control loss: 759.1219658788796
epoch: 79, Treated + Control loss: 751.1596348944902
epoch: 89, Treated + Control loss: 751.5591704640095
epoch: 99, Treated + Control loss: 752.7989157797367
SAE all layer active start time: = 2024-12-23 13:50:46.989882
SAE all layer active end time: = 2024-12-23 13:55:34.893535
---------------------------------------------------------------------------
Layer wise greedy stacked SAE training - Current layers
---------------------------------------------------------------------------
.. Propensity score evaluation started using Sparse AE ..
.. Propensity score evaluation completed Sparse AE ..
############### DCN Training using SAE ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/SAE_stacked_cur_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 855.3837929671004
epoch: 19, Treated + Control loss: 819.0179359741603
epoch: 29, Treated + Control loss: 788.5793071804051
epoch: 39, Treated + Control loss: 770.2043067670542
epoch: 49, Treated + Control loss: 766.9843987087609
epoch: 59, Treated + Control loss: 781.837255921074
epoch: 69, Treated + Control loss: 759.4147409226655
epoch: 79, Treated + Control loss: 737.8083951377605
epoch: 89, Treated + Control loss: 749.4802075858055
epoch: 99, Treated + Control loss: 744.9697278670787
SAE cur layer active start time: = 2024-12-23 13:55:34.893559
SAE all layer active end time: = 2024-12-23 14:00:22.709659
############### DCN Training using Logistic Regression ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/LR_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 845.126425622881
epoch: 19, Treated + Control loss: 804.4861018331819
epoch: 29, Treated + Control loss: 781.6061725219407
epoch: 39, Treated + Control loss: 768.0539127693867
epoch: 49, Treated + Control loss: 757.0763706329387
epoch: 59, Treated + Control loss: 764.2043919012577
epoch: 69, Treated + Control loss: 750.2388148190405
epoch: 79, Treated + Control loss: 735.7152710178625
epoch: 89, Treated + Control loss: 715.6053880334301
epoch: 99, Treated + Control loss: 733.4453909513526
Logistic Regression start time: = 2024-12-23 14:00:22.709694
Logistic Regression end time: = 2024-12-23 14:05:11.907202
############### DCN Training using Logistic Regression Lasso ###############
Treated Statistics ==>
torch.Size([237, 17])
Control Statistics ==>
torch.Size([2333, 17])
Saved model path: ./DCNModel/LR_Lasso_DCN_model_iter_id_0_epoch_100_lr_0.0001.pth
.. Training started ..
cuda:0
epoch: 9, Treated + Control loss: 844.292094199022
epoch: 19, Treated + Control loss: 826.3988423863393
epoch: 29, Treated + Control loss: 781.0733924772661
epoch: 39, Treated + Control loss: 819.0501227523862
epoch: 49, Treated + Control loss: 795.8275050181255
epoch: 59, Treated + Control loss: 762.7678112078919
epoch: 69, Treated + Control loss: 754.3620371086749
epoch: 79, Treated + Control loss: 752.3489605168132
epoch: 89, Treated + Control loss: 745.1273615491696
epoch: 99, Treated + Control loss: 758.5150656279103
Logistic Regression Lasso start time: = 2024-12-23 14:05:11.907263
Logistic Regression Lasso end time: = 2024-12-23 14:10:01.102092
----------- Testing phase ------------
############### DCN Testing using NN ###############
.. Propensity score evaluation started using NN..
.. Propensity score evaluation completed using NN..
Treated Statistics ==>
torch.Size([60, 17])
Control Statistics ==>
torch.Size([582, 17])
tensor_x size: torch.Size([60, 17])
tensor_ps_score size: torch.Size([60])
tensor_y_f size: torch.Size([60])
